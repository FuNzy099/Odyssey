{% extends 'base.html.twig' %}

{% block title %}Messagerie{% endblock %}

{% block stylesheets %}

    <link href="{{ asset('css/layoutStyles/layout.css') }}" type="text/css" rel="stylesheet" />

    <link href="{{ asset('css/messageStyles/message.css') }}" type="text/css" rel="stylesheet" />

{% endblock %}

{% block body %}

    <main>

        {# Section contenant la liste des utilisateur avec qui ont a echangé #}
        <section class="listUser1">
   
            <div class="container">

                <div class="infoContainerSender">
                    <h1>Messagerie</h1>
                    <i class="fa-regular fa-pen-to-square fa-xl"></i>
                </div>

                {# 
                {% for truc in messages.sender.id %}

                    {{ dump(truc) }}

                    <div class="{{bold}} senderContainer">
                        <a href="{{ path("app_read", {"id": message.id})}}" class="link">
                            <figure class="senderAvatar">
                                <img id="edit_profil_avatar_preview" src="{{ asset('img/avatars/' ~ message.sender.avatar) }}" class="avatar" alt="Image de profil de l'utilisateur !">
                            </figure>

                            <p class="senderPseudonyme">{{message.sender.pseudonyme}}</p>
                            
                            <p class="senderDate">
                                {{message.creationDate|date("d M Y")}}
                            </p>
                        </a>
                    </div>
                
                {% endfor %} 
                #}
    
                {% for message in app.user.received %}
                
                    {% if message.isRead == 0 %}
                        {% set bold = "fw-bold" %}
                    {% else %}
                        {% set bold = "" %}
                    {% endif %}
    
                    
                    
                    <div class="{{bold}} senderContainer">
                        <a href="{{ path("app_read", {"id": message.id})}}" class="link">
                            <figure class="senderAvatar">
                                <img id="edit_profil_avatar_preview" src="{{ asset('img/avatars/' ~ message.sender.avatar) }}" class="avatar" alt="Image de profil de l'utilisateur !">
                            </figure>
    
                            <p class="senderPseudonyme">{{message.sender.pseudonyme}}</p>
                            
                            <p class="senderDate">
                                {{message.creationDate|date("d M Y")}}
                            </p>
                        </a>
                    </div>
                {% endfor %}
    
                <div class="col">
                    <a href="{{ path("send")}}" class="btn btn-primary">Envoyer un message</a>
                </div>
                
            </div>
        
        </section>


        {# Section contenant le fil de discution un utilisateur en particulier #}
        <section class="discussion">

            <div class="infoContainerDiscussion">
                <h1>Conversation</h1>
            </div>

            <div class="discussionThread">

                {% for message in app.user.send %}

                    <p class="bubbleYou">{{message.message}}</p> <br>
                
                {% endfor %}

            
                {% for message in app.user.received %}

                    <p class="bubbleMe">{{message.message}}</p> <br>
            
                {% endfor %}




                {# 
                <div class="row">
                    <div class="col-12">
                        <h1>Messagerie</h1>
            
                        <h2>{{message.title}}</h2>
                        <p>Message de {{message.sender.pseudonyme}}</p>
                        <p>Le {{message.creationDate|date}}</p>
                        <div>{{message.message}}</div>
                    
            
                    <div class="col">
                        <a href="{{ path("app_received")}}" class="btn btn-primary">Retour à la boite de réception</a>
                    </div>
                </div>
                #}
            </div>


            {# <div class="row">
                <div class="col-12">
                    <h1>Messagerie</h1>
        
                    <h2>{{message.title}}</h2>
                    <p>Message de {{message.sender.pseudonyme}}</p>
                    <p>Le {{message.creationDate|date}}</p>
                    <div>{{message.message}}</div>
                   
        
                    <div class="col">
                        <a href="{{ path("app_received")}}" class="btn btn-primary">Retour à la boite de réception</a>
                    </div>
                </div>
            </div> #}
        </section>
    </main>

  {# <section class="container">
       
  </section> #}

{% endblock %}

{% block javascripts %}

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3" crossorigin="anonymous"></script>
    <script src="https://kit.fontawesome.com/7d0ef989cc.js" crossorigin="anonymous"></script>

{% endblock %}
